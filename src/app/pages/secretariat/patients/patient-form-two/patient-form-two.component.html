<div class="row">
  <div class="col-xl-12">
    <div class="card">
      <div class="card-header">
        <h4 class="card-title mb-0">Nouveau patient</h4>
      </div>
      <!-- end card header -->
      <div class="card-body">
        <div>
          <p>
            Veuillez fournir les informations suivantes
            <br />
            <em
              >Les champs marqués par <span class="text-danger">*</span> sont
              obligatoires</em
            >
          </p>
        </div>

        <hr />

        <form [formGroup]="patientInfoForm">
          <div class="row">
            <!-- FIRST COLUMN -->
            <div class="col-12 col-lg-6 border-dark border-end">
              <div class="row g-3">
                <div class="col-md-6">
                  <div class="mb-3">
                    <app-input
                      label="Nom"
                      placeholder="Sasir le nom du patient"
                      [isMandatory]="true"
                      [capitalized]="true"
                      [control]="lastNameControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    >
                    </app-input>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <app-input
                      label="Prénom(s)"
                      placeholder="Saisir le(s) prénom(s) du patient"
                      [isMandatory]="true"
                      [titleCased]="true"
                      [control]="firstNameControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    >
                    </app-input>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="mb-3">
                    <app-input
                      label="Né(e) le"
                      type="date"
                      [isMandatory]="true"
                      [maxDate]="today"
                      [control]="dateOfBirthControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    >
                    </app-input>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <app-input
                      label="Âge"
                      [control]="ageControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                      >
                      <!-- [readOnly]="true" -->
                    </app-input>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="mb-3">
                    <app-select
                      label="Sexe"
                      [isMandatory]="true"
                      [options]="genders"
                      [control]="genderControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    ></app-select>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <app-input
                      label="Né(e) à"
                      placeholder="Saisir le lieu de naissance"
                      [control]="birthPlaceControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    >
                    </app-input>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="mb-3">
                    <app-select
                      label="Assuré(e)"
                      [isMandatory]="true"
                      [options]="hasInsurances"
                      [control]="hasInsuranceControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    ></app-select>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="mb-3">
                    <app-select
                      label="Assureur"
                      [isMandatory]="true"
                      [options]="insurances"
                      [canAddOption]="true"
                      [control]="insuranceControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    ></app-select>
                  </div>
                </div>
                <div class="col-md-2">
                  <div class="mb-3">
                    <app-input
                      label="Taux de PEC"
                      placeholder="Taux de prise en charge du patient"
                      [isMandatory]="true"
                      maskFormat="percent"
                      maskSuffix=" %"
                      [control]="insuranceRateControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    >
                    </app-input>
                  </div>
                </div>

                <div
                  class="col-md-6"
                  *ngIf="hasInsuranceControl.value?.id >= 2"
                >
                  <div class="mb-3">
                    <app-select
                      label="Type de l'assurance"
                      [isMandatory]="true"
                      [options]="insuranceTypes"
                      [control]="insuranceTypeControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    ></app-select>
                  </div>
                </div>
                <!-- <div class="col-md-6"></div> -->

                <div class="col-md-6">
                  <div class="mb-3">
                    <app-select
                      label="Pays d'origine"
                      [isMandatory]="true"
                      [options]="countries"
                      [control]="homelandControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    ></app-select>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <app-select
                      label="Nationalité"
                      [options]="nationalities"
                      [control]="nationalityControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    ></app-select>
                  </div>
                </div>
              </div>

              <!-- END FIRST COLUMN -->
            </div>

            <!-- SECOND COLUMN -->
            <div class="col-12 col-lg-6 border-dark border-start">
              <div class="row g-3">
                <div class="col-md-6">
                  <div class="mb-3">
                    <app-select
                      label="Profession"
                      [options]="professions"
                      [canAddOption]="true"
                      [control]="professionControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    ></app-select>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <app-select
                      label="Employeur de l'assuré"
                      [isMandatory]="isEmployerMandatory"
                      [options]="employers"
                      [canAddOption]="true"
                      [control]="patientEmployerControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    ></app-select>
                  </div>
                </div>

                <div class="col-md-12">
                  <div class="mb-3">
                    <app-input
                      label="Adresse"
                      placeholder="Ville, Quartier, Rue, BP, Arrondissement, N° maison"
                      [readOnly]="true"
                      [isMandatory]="true"
                      [control]="patientAddressControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                      [emitOnInputClick]="true"
                      (onInputClick)="onPatientAddressClick()"
                    >
                    </app-input>
                    <!-- <app-input
                      label="Adresse"
                      placeholder="Rue, BP, Arrondissement, N° maison"
                      [control]="patientAddressControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    >
                    </app-input> -->
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="mb-3">
                    <app-input
                      label="Cellulaire 1"
                      type="tel"
                      placeholder="XX XX XX XX"
                      [isMandatory]="true"
                      [control]="patientTel1Control"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                      maskFormat="09 09 09 09 09 09 09 09 09 09"
                    >
                    </app-input>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="mb-3">
                    <app-input
                      label="Cellulaire 2"
                      type="tel"
                      placeholder="XX XX XX XX"
                      [control]="patientTel2Control"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                      maskFormat="09 09 09 09 09 09 09 09 09 09"
                    >
                    </app-input>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="mb-3">
                    <app-input
                      label="Téléphone 1"
                      type="tel"
                      placeholder="XX XX XX XX"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                      maskFormat="09 09 09 09 09 09 09 09 09 09"
                    >
                    </app-input>
                  </div>
                </div>

                <div class="col-md-12">
                  <div class="mb-3">
                    <app-input
                      label="Personne à prévenir"
                      placeholder="Nom, prénom(s), contact, adresse"
                      [readOnly]="true"
                      [isMandatory]="true"
                      [control]="personToContactControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                      [emitOnInputClick]="true"
                      (onInputClick)="onPersonToContactClick()"
                    >
                    </app-input>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="row g-1 mb-3">
                    <div class="col-4">
                      <app-select
                        label="Type"
                        [options]="idTypes"
                        [control]="idTypeControl"
                        [isFormSubmitted]="isPatientInfoFormSubmitted"
                      ></app-select>
                    </div>
                    <div class="col-8">
                      <app-input
                        label="N° Pièce"
                        placeholder="N° de la pièce d'identité"
                        [control]="idNumberControl"
                        [isFormSubmitted]="isPatientInfoFormSubmitted"
                      >
                      </app-input>
                    </div>
                  </div>
                </div>

                <!-- <div class="col-md-4">
                  <div class="mb-3">
                    <app-input
                      label="Email"
                      type="email"
                      placeholder="test@example.org"
                      [control]="patientEmailControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    >
                    </app-input>
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="mb-3">
                    <app-input
                      label="Date de début PEC"
                      type="date"
                      [maxDate]="today"
                      [control]="insuranceStartControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    >
                    </app-input>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="mb-3">
                    <app-input
                      label="Date de fin PEC"
                      type="date"
                      [minDate]="today"
                      [control]="insuranceEndControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    >
                    </app-input>
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="mb-3">
                    <app-input
                      label="Téléphone 1"
                      type="tel"
                      placeholder="XX XX XX XX"
                      [control]="insuranceTel1Control"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                      maskFormat="00 00 00 00"
                    >
                    </app-input>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="mb-3">
                    <app-input
                      label="Téléphone 2"
                      type="tel"
                      placeholder="XX XX XX XX"
                      [control]="insuranceTel2Control"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                      maskFormat="00 00 00 00"
                    >
                    </app-input>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="mb-3">
                    <app-input
                      label="Email"
                      type="email"
                      placeholder="test@example.org"
                      [control]="insuranceEmailControl"
                      [isFormSubmitted]="isPatientInfoFormSubmitted"
                    >
                    </app-input>
                  </div>
                </div> -->
              </div>

              <!-- END SECOND COLUMN -->
            </div>
          </div>
        </form>

        <div class="d-flex align-items-start gap-3 mt-4">
          <button
            type="button"
            class="btn btn-secondary btn-label ms-auto"
            data-nexttab="v-pills-finish-tab"
            (click)="registerPatientAndLeave()"
          >
            <i class="ri-save-2-fill label-icon align-middle fs-16 me-2"></i>
            Enregistrer et quitter
          </button>
          <button
            type="button"
            class="btn btn-success btn-label right"
            data-nexttab="v-pills-finish-tab"
            (click)="registerPatientAndContinue()"
          >
            <i
              class="ri-arrow-right-line label-icon align-middle fs-16 ms-2"
            ></i>
            Continuer vers Activités/Prestations
          </button>
        </div>
      </div>
    </div>
    <!-- end -->
  </div>
  <!-- end col -->
</div>
