<div class="modal-header border-bottom border-1 border-dark">
  <h5 class="modal-title">Consultations antérieures</h5>
  <button
    type="button"
    class="btn-close btn-danger"
    data-bs-dismiss="modal"
    aria-label="Close"
    (click)="modal.close('Close click')"
  ></button>
</div>

<div class="modal-body">
  <form [formGroup]="patientVisitForm">
    <!-- FIRST PART -->
    <div class="row mb-2">
      <div class="col-md-4">
        <app-input
          type="date"
          label="Date de consultation"
          [control]="visitDateControl"
        ></app-input>
      </div>

      <div class="col-md-4">
        <app-input
          [readOnly]="true"
          label="Médecin consulteur"
          [control]="visitDoctorControl"
        >
        </app-input>
      </div>

      <div class="col-md-4">
        <app-select
          label="Secteur"
          [clearable]="false"
          [options]="sectors"
          [control]="visitSectorControl"
        ></app-select>
      </div>
    </div>

    <hr />

    <!-- SECOND PART -->
    <div class="row mb-2">
      <div class="col-md-2">
        <app-input
          type="number"
          label="Poids (kg)"
          [control]="weightControl"
        ></app-input>
      </div>

      <div class="col-md-2">
        <app-input
          type="number"
          label="Taille (cm)"
          [control]="sizeControl"
        ></app-input>
      </div>

      <div class="col-md-1">
        <app-input
          type="number"
          label="PC (cm)"
          [control]="pcControl"
        ></app-input>
      </div>

      <div class="col-md-2">
        <app-input
          type="number"
          label="Température (°C)"
          [control]="temperatureControl"
        ></app-input>
      </div>

      <div class="col-md-1">
        <app-input type="number" label="FR" [control]="frControl"></app-input>
      </div>

      <div class="col-md-2">
        <app-input
          type="number"
          label="Pouls"
          [control]="pulseControl"
        ></app-input>
      </div>

      <div class="col-md-2">
        <app-input
          label="Tension (mmHg)"
          placeholder="___ / ___"
          [control]="tensionControl"
        ></app-input>
      </div>
    </div>

    <hr />

    <!-- THIRD PART -->
    <div class="row mb-2">
      <div class="col-md-4">
        <div class="row g-2">
          <!-- <div class="col-md-2 d-flex align-items-center">
                <label class="form-label m-0">Acte</label>
              </div> -->
          <ng-container formArrayName="acts">
            <ng-container
              *ngFor="let act of actsFields.controls; let i = index"
            >
              <div class="col-md-8">
                <app-select
                  [label]="'Acte ' + (i + 1)"
                  [options]="acts"
                  [control]="act"
                ></app-select>
              </div>
              <div class="col-md-4 d-flex align-items-end">
                <button
                  type="button"
                  class="btn btn-dark btn-icon waves-effect waves-light me-1"
                  (click)="addActsField()"
                >
                  <i class="ri-add-fill fs-24"></i>
                </button>
                <button
                  type="button"
                  class="btn btn-dark btn-icon waves-effect waves-light"
                  (click)="removeActsField(i)"
                >
                  <i class="ri-subtract-fill fs-24"></i>
                </button>
              </div> </ng-container
          ></ng-container>
        </div>
      </div>

      <div class="col-md-4">
        <div class="row g-2">
          <!-- <div class="col-md-2 d-flex align-items-center">
                <label class="form-label m-0">Motif</label>
              </div> -->
          <ng-container formArrayName="motifs">
            <ng-container
              *ngFor="let motif of motifsFields.controls; let i = index"
            >
              <div class="col-md-8">
                <div class="col-md-12">
                  <app-select
                    [label]="'Motif ' + (i + 1)"
                    [options]="motifs"
                    [isLoading]="motifsAreLoading"
                    [typeahead]="motifsTypeahead$"
                    [control]="motif"
                  ></app-select>
                </div>
              </div>
              <div class="col-md-4 d-flex align-items-end">
                <button
                  type="button"
                  class="btn btn-dark btn-icon waves-effect waves-light me-1"
                  (click)="addMotifsField()"
                >
                  <i class="ri-add-fill fs-24"></i>
                </button>
                <button
                  type="button"
                  class="btn btn-dark btn-icon waves-effect waves-light"
                  (click)="removeMotifsField(i)"
                >
                  <i class="ri-subtract-fill fs-24"></i>
                </button>
              </div>
              <div class="col-md-8">
                <textarea
                  class="form-control"
                  placeholder="Caractères du motif"
                  rows="2"
                ></textarea>
                <!-- [formControl]="diseaseHistoryControl" -->
              </div>
            </ng-container></ng-container
          >
        </div>
      </div>

      <div class="col-md-4">
        <div class="row g-2">
          <!-- <div class="col-md-3 d-flex align-items-center">
                <label class="form-label m-0">Diagnostic</label>
              </div> -->
          <ng-container formArrayName="diagnostics">
            <ng-container
              *ngFor="
                let diagnostic of diagnosticsFields.controls;
                let i = index
              "
            >
              <div class="col-md-8">
                <app-select
                  [label]="'Diagnostic ' + (i + 1)"
                  [options]="diagnostics"
                  [isLoading]="diagnosticsAreLoading"
                  [typeahead]="diagnosticsTypeahead$"
                  [control]="diagnostic"
                ></app-select>
              </div>
              <div class="col-md-4 d-flex align-items-end">
                <button
                  type="button"
                  class="btn btn-dark btn-icon waves-effect waves-light me-1"
                  (click)="addDiagnosticsField()"
                >
                  <i class="ri-add-fill fs-24"></i>
                </button>
                <button
                  type="button"
                  class="btn btn-dark btn-icon waves-effect waves-light"
                  (click)="removeDiagnosticsField(i)"
                >
                  <i class="ri-subtract-fill fs-24"></i>
                </button>
              </div>
              <div class="col-md-8">
                <textarea
                  class="form-control"
                  placeholder="Commentaies du diagnostic"
                  rows="2"
                ></textarea>
                <!-- [formControl]="diseaseHistoryControl" -->
              </div>
            </ng-container></ng-container
          >
        </div>
      </div>
    </div>

    <hr />

    <!-- THIRD PART -->
    <div class="row">
      <div class="col-lg-9">
        <div class="col-md-12 mb-3">
          <label for="diseaseHistory" class="form-label">
            Histoire de la maladie
          </label>
          <textarea
            id="diseaseHistory"
            class="form-control"
            placeholder="..."
            rows="3"
            [formControl]="diseaseHistoryControl"
          ></textarea>
        </div>

        <!-- <div class="col-md-12 mb-md-3 mb-lg-0">
          <label for="diseaseHistory" class="form-label">
            Médicaments prescrits
          </label>
          <textarea
            id="diseaseHistory"
            class="form-control"
            placeholder="..."
            rows="3"
            [formControl]="prescribedMedicationControl"
          ></textarea>
        </div> -->
      </div>

      <div class="col-lg-3 d-flex align-items-end">
        <div class="row gy-3">
          <div class="col-md-6 d-grid">
            <button
              class="btn btn-outline-info"
              (click)="prev()"
              [disabled]="activeIndex === consultations.length - 1"
            >
              <b>Précédent</b>
            </button>
          </div>
          <div class="col-md-6 d-grid">
            <button
              class="btn btn-outline-info"
              (click)="next()"
              [disabled]="activeIndex === 0"
            >
              <b>Suivant</b>
            </button>
          </div>
        </div>
      </div>

      <!-- <div class="col-lg-3 d-flex align-items-end">
        <div class="row gy-3">
          <div class="col-md-6 d-grid">
            <button class="btn btn-outline-secondary">
              <b>Ordonnancier</b>
            </button>
          </div>
          <div class="col-md-6 d-grid">
            <button
              class="btn btn-outline-success"
              (click)="openAppointmentModal()"
            >
              <b>Rendez-vous</b>
            </button>
          </div>

          <div class="col-md-6 d-grid">
            <button class="btn btn-outline-success"><b>Examens</b></button>
          </div>
          <div class="col-md-6 d-grid">
            <button class="btn btn-outline-secondary">
              <b>Hospitaliser</b>
            </button>
          </div>

          <div class="col-md-6 d-grid">
            <button
              type="button"
              class="btn btn-outline-secondary btn-label btn-sm"
              (click)="saveVisitInfos()"
            >
              <i class="ri-save-2-line label-icon align-middle fs-16 me-2"></i>

              Enregistrer et retourner sur la liste d'attente
            </button>
          </div>
          <div class="col-md-6 d-grid">
            <button
              type="button"
              class="btn btn-outline-success btn-label btn-sm"
              (click)="saveVisitInfos()"
            >
              <i class="ri-save-2-fill label-icon align-middle fs-16 me-2"></i>

              Enregistrer et quitter
            </button>
          </div>

          <div class="col-md-6 d-grid">
            <button class="btn btn-outline-success"><b>ATRD</b></button>
          </div>
          <div class="col-md-6 d-grid">
            <button class="btn btn-outline-secondary"><b>M-U</b></button>
          </div>
        </div>
      </div> -->
    </div>
  </form>
</div>

<div class="modal-footer py-1 border-top border-1 border-dark">
  <a
    href="javascript:void(0);"
    class="btn btn-link link-success fw-medium shadow-none"
    data-bs-dismiss="modal"
    (click)="modal.close('Close click')"
    ><i class="ri-close-line me-1 align-middle"></i>Fermer</a
  >
  <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
</div>
